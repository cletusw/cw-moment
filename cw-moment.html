<link rel="import" href="../polymer/polymer.html">
<script src="../momentjs/min/moment-with-langs.min.js"></script>

<!--
A Polymer wrapper for moment.js.

##### Example

    <cw-moment datetime="2014-06-05T20:40:26" fromNow></cw-moment>

@element cw-moment
@homepage http://cletusw.github.io/cw-moment
-->
<polymer-element name="cw-moment">

  <template>

    <link rel="stylesheet" href="cw-moment.css" />

    <content></content>

  </template>

  <script>

    Polymer('cw-moment', {

      publish: {
        datetime: '',
        format: '',
        formats: {
          reflect: true,
          value: []
        },
        fromNow: false,
        lang: '',
        noSuffix: false,
        strict: false,
        unixOffset: 0,
        unixTimestamp: 0,
        utc: false
      },

      moment: {},

      attributeChanged: function(attributeName, oldValue, newValue) {
        this.createMoment();
      },

      created: function() {
        this.formats = [];
      },

      createMoment: function() {
        if (this.unixOffset) {
          this.moment = moment(this.unixOffset);
        }
        else if (this.unixTimestamp) {
          this.moment = moment.unix(this.unixTimestamp);
        }
        else {
          var fn = this.utc ? moment.utc : moment;
          this.moment = fn(this.datetime || undefined, this.format || ((this.formats && this.formats.length) ? this.formats : undefined), this.lang || undefined, this.strict || undefined);
        }
      },

      momentChanged: function() {
        this.innerText = (this.fromNow) ? this.moment.fromNow(this.noSuffix) : this.moment.format();
      },

      ready: function() {
        this.createMoment();
      }

    });

  </script>

</polymer-element>
